<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Primary SEO Meta Tags -->
    <title>8-Bit Composer ‚Äì Free Online Chiptune Music Maker & Sequencer</title>
    <meta name="description" content="Create nostalgic 8-bit chiptune music online with our free browser-based sequencer. Drag-and-drop grid interface, export to WAV, and share your retro compositions instantly. No downloads required!" />
    <meta name="author" content="Dorian Smith" />
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.8bitcomposer.com/" />
    
    <!-- Enhanced Keywords (though less important now) -->
    <meta name="keywords" content="8-bit music maker, chiptune creator, online music sequencer, retro music composer, pixel music, video game music, NES music, gameboy music, free music software, browser music maker" />

    <!-- Open Graph (Facebook, Discord, etc.) -->
    <meta property="og:title" content="8-Bit Composer ‚Äì Free Online Chiptune Music Maker" />
    <meta property="og:description" content="Create and share nostalgic 8-bit style music with our free online sequencer. Perfect for game developers, musicians, and retro enthusiasts." />
    <meta property="og:image" content="https://s3.us-west-2.amazonaws.com/www.8bitcomposer.com/logo.png" />
    <meta property="og:url" content="https://www.8bitcomposer.com/" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="8-Bit Composer" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="8-Bit Composer ‚Äì Free Online Chiptune Music Maker" />
    <meta name="twitter:description" content="Create nostalgic 8-bit music in your browser. Free online sequencer with export and sharing features." />
    <meta name="twitter:image" content="https://s3.us-west-2.amazonaws.com/www.8bitcomposer.com/logo.png" />
    <meta name="twitter:creator" content="@yourtwitterhandle" />

    <!-- Favicon and App Icons -->
    <link rel="icon" type="image/png" href="https://s3.us-west-2.amazonaws.com/www.8bitcomposer.com/logo.png" sizes="32x32" />
    <link rel="apple-touch-icon" href="https://s3.us-west-2.amazonaws.com/www.8bitcomposer.com/logo.png" />

    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="/style.css" />

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "8-Bit Composer",
      "description": "Free online chiptune music maker and sequencer for creating retro 8-bit style music",
      "url": "https://www.8bitcomposer.com/",
      "applicationCategory": "MusicApplication",
      "operatingSystem": "Web Browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "creator": {
        "@type": "Person",
        "name": "Dorian Smith",
        "url": "https://doriansmith.dev"
      },
      "featureList": [
        "Drag and drop sequencer",
        "Multiple 8-bit instruments",
        "WAV export functionality",
        "Composition sharing",
        "Real-time playback",
        "Loop and tempo controls"
      ]
    }
    </script>

    <!-- Tailwind setup -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              bg: '#080808',
              fg: '#0f0',
              control: '#222',
              accent: '#0f0',
              'cell-border': '#555',
            },
            fontFamily: {
              pixel: ["'Press Start 2P'", 'monospace'],
            },
            spacing: {
              gap: '4px',
            },
          },
        },
      };
    </script>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3DLZRJN22L"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() { dataLayer.push(arguments); }
      gtag('js', new Date());
      gtag('config', 'G-3DLZRJN22L');
    </script>

    <!-- Google Ads -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7267090092112889" crossorigin="anonymous"></script>
  </head>

  <body class="bg-bg text-fg font-pixel p-4">
    <!-- Skip Navigation for Accessibility -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 bg-accent text-bg p-2">Skip to main content</a>
    
    <header>
      <div id="navbar"></div>
    </header>

    <script>
      fetch("/navbar.html")
        .then(res => res.text())
        .then(html => {
          document.getElementById("navbar").innerHTML = html;
          const toggle = document.getElementById("nav-toggle");
          const menu = document.getElementById("nav-menu");
          toggle?.addEventListener("click", () => {
            menu?.classList.toggle("hidden");
          });
        })
        .catch(err => console.error("Failed to load navbar:", err));
    </script>

    <!-- Main Content with Semantic Structure -->
    <main id="main-content">
      <!-- Hero Section -->
      <section class="text-center mb-8">
        <h1 class="text-2xl md:text-3xl mb-4 text-accent">Free Online 8-Bit Music Composer</h1>
        <p class="text-xs md:text-sm mb-6 max-w-2xl mx-auto leading-5">
          Create nostalgic chiptune music with our browser-based sequencer. Perfect for game developers, musicians, and retro enthusiasts. No downloads required ‚Äì start composing instantly!
        </p>
      </section>

      <!-- Controls Section -->
      <section id="controls-section" aria-label="Music composition controls">
        <h2 class="sr-only">Playback and Composition Controls</h2>
        <div
          id="controls"
          class="w-4/5 max-w-[1200px] mx-auto mb-4
                grid grid-cols-[repeat(auto-fit,minmax(4rem,1fr))]
                gap-gap justify-center items-center
                bg-control border-4 border-accent p-2 rounded"
          role="toolbar"
          aria-label="Music controls"
        >
          <button id="play" title="Play composition" aria-label="Play"><i class="fa-solid fa-play"></i></button>
          <button id="stop" title="Stop playback" aria-label="Stop"><i class="fa-solid fa-stop"></i></button>
          <button id="pause" title="Pause playback" aria-label="Pause"><i class="fa-solid fa-pause"></i></button>
          <button id="loop-btn" title="Toggle loop mode" aria-label="Toggle Loop"><i class="fas fa-sync-alt"></i></button>
          <button id="clear" title="Clear all notes" aria-label="Clear Notes"><i class="fa-solid fa-broom"></i></button>
          <button id="reset-btn" title="Reset to fresh slate" aria-label="Fresh Slate"><i class="fa-solid fa-rotate-right"></i></button>
          <button id="export" title="Export composition to WAV file" aria-label="Export to WAV"><i class="fas fa-file-export"></i></button>
          <button id="share-btn" title="Share your composition" aria-label="Share Composition"><i class="fas fa-share-alt"></i></button>
          <button id="help-btn" title="Show help information" aria-label="Help">?</button>

          <!-- Steps wrapper -->
          <div class="flex flex-col items-center gap-1">
            <label for="steps-input" class="text-[0.65rem]">Steps</label>
            <input
              id="steps-input"
              type="number"
              min="1"
              value="16"
              title="Number of steps per loop"
              aria-label="Steps per loop"
              class="w-full bg-control border-4 border-cell-border text-fg text-center"
            />
          </div>

          <!-- BPM wrapper -->
          <div class="flex flex-col items-center gap-1">
            <label for="bpm-input" class="text-[0.65rem]">BPM</label>
            <input
              id="bpm-input"
              type="number"
              min="1"
              max="300"
              value="80"
              title="Beats per minute (tempo)"
              aria-label="Beats per minute"
              class="w-full bg-control border-4 border-cell-border text-fg text-center"
            />
          </div>
        </div>
      </section>

      <!-- AI Generation Section -->
      <section id="generate-section" aria-label="AI music generation">
        <h2 class="sr-only">AI-Powered Music Generation</h2>
        <div
          id="generate-controls"
          class="w-4/5 max-w-[1200px] mx-auto mb-4
                bg-control border-4 border-accent p-2 rounded
                flex flex-col gap-gap font-pixel text-[0.75rem]"
        >
          <div id="generate-status" class="min-h-[1.25rem]" aria-live="polite"></div>
          <div id="generate-inputs" class="flex gap-gap">
            <textarea
              id="generate-prompt"
              rows="2"
              placeholder="Describe the type of 8-bit track you want (e.g., 'upbeat battle theme' or 'peaceful village music')..."
              aria-label="Music generation prompt"
              class="flex-1 bg-control border-4 border-cell-border text-fg p-2 text-[0.65rem] resize-y"
            ></textarea>
            <button id="generate-btn" aria-label="Generate music from prompt" class="bg-control border-4 border-cell-border text-fg py-2 px-4 text-[0.65rem]">üõ†Ô∏è Generate</button>
          </div>
        </div>
      </section>

      <!-- Music Sequencer Grid -->
      <section id="grid-section" aria-label="Music sequencer grid">
        <h2 class="sr-only">Music Composition Grid</h2>
        <div id="grid" class="w-4/5 max-w-[1200px] mx-auto overflow-x-auto" role="grid" aria-label="Music sequencer grid"></div>
      </section>

      <!-- Share Status -->
      <section id="share-section" aria-label="Sharing status">
        <div id="share-status"
          class="w-4/5 max-w-[1200px] mx-auto mb-4 text-[0.65rem] text-center text-fg font-pixel min-h-[1.25rem]"
          aria-live="polite">
        </div>
      </section>

      <!-- Features Section for SEO -->
      <section class="w-4/5 max-w-[1200px] mx-auto mt-12 mb-8">
        <h2 class="text-lg mb-6 text-center text-accent">Why Choose 8-Bit Composer?</h2>
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 text-[0.7rem] leading-relaxed">
          <article class="bg-control border-2 border-cell-border p-4 rounded">
            <h3 class="text-accent mb-2">üéµ Easy to Use</h3>
            <p>Intuitive grid-based interface makes creating chiptune music accessible to everyone, from beginners to professionals.</p>
          </article>
          <article class="bg-control border-2 border-cell-border p-4 rounded">
            <h3 class="text-accent mb-2">ü§ñ AI-Powered</h3>
            <p>Generate unique 8-bit compositions using AI. Describe your vision and let our algorithm create the perfect retro soundtrack.</p>
          </article>
          <article class="bg-control border-2 border-cell-border p-4 rounded">
            <h3 class="text-accent mb-2">üíæ Export & Share</h3>
            <p>Download your creations as high-quality WAV files or share them instantly with a unique link. Perfect for game development.</p>
          </article>
          <article class="bg-control border-2 border-cell-border p-4 rounded">
            <h3 class="text-accent mb-2">üéÆ Authentic Sound</h3>
            <p>Recreate the classic 8-bit sound of NES, Game Boy, and other retro gaming consoles with authentic waveforms and filters.</p>
          </article>
          <article class="bg-control border-2 border-cell-border p-4 rounded">
            <h3 class="text-accent mb-2">‚ö° Browser-Based</h3>
            <p>No downloads or installations required. Create music directly in your web browser on any device, anywhere.</p>
          </article>
          <article class="bg-control border-2 border-cell-border p-4 rounded">
            <h3 class="text-accent mb-2">üÜì Free to Use</h3>
            <p>Create, edit, export, and share your compositions for free. AI generation features available with affordable credit system. No watermarks on your music.</p>
          </article>
        </div>
      </section>
    </main>

    <!-- Help Modal -->
    <aside 
      id="help-modal"
      class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center hidden z-50"
      role="dialog"
      aria-labelledby="help-modal-title"
      aria-modal="true"
    >
      <div class="bg-control border-4 border-accent text-fg font-pixel p-6 rounded-lg w-[90%] max-w-lg relative shadow-lg">
        <button
          id="close-help"
          class="absolute top-3 right-4 text-fg text-xl hover:text-accent"
          aria-label="Close help modal"
        >
          &times;
        </button>

        <h2 id="help-modal-title" class="text-base tracking-wide mb-4 text-center">üïπÔ∏è How to Use 8-Bit Composer</h2>

        <ul class="space-y-2 text-[0.65rem] leading-snug list-disc pl-5">
          <li><strong>Click grid cells</strong> to toggle notes on/off.</li>
          <li><strong>Right-click a note</strong> to edit pitch.</li>
          <li><strong>Use instrument dropdowns and sliders</strong> to customize each row.</li>
          <li><strong>Click "Generate"</strong> to use AI to create music from your prompt.</li>
          <li><strong>AI is iterative:</strong> It modifies your current composition based on your prompt.</li>
          <li><strong>Click "Fresh Slate"</strong> before generating to start from scratch.</li>
          <li><strong>Click "Export to WAV"</strong> to save your composition locally.</li>
        </ul>
      </div>
    </aside>

    <footer class="text-center mt-12 border-t-2 border-cell-border pt-8">
      <p class="text-[0.6rem] mt-2 text-fg font-pixel">
        Powered by pixels and patterns <br />
        Crafted with love by <a href='https://doriansmith.dev' target="_blank" rel="noopener" class="underline hover:text-accent"> Dorian Smith </a>
      </p>
      <p class="copyright-text text-[0.6rem] mt-2 text-fg font-pixel">
        <span id="copyright-year" style="font-weight:bold;"></span> &copy; All bleeps and bloops reserved.
      </p>
    </footer>
      
    <!-- Scripts -->
    <script>
      document.getElementById("copyright-year").textContent = `${new Date().getFullYear()}`;
    </script>

    <script>
      document.getElementById("help-btn").addEventListener("click", () => {
        document.getElementById("help-modal").classList.remove("hidden");
        document.getElementById("help-modal").focus();
      });

      document.getElementById("close-help").addEventListener("click", () => {
        document.getElementById("help-modal").classList.add("hidden");
      });

      window.addEventListener("click", (e) => {
        const modal = document.getElementById("help-modal");
        if (e.target === modal) {
          modal.classList.add("hidden");
        }
      });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/tone@latest/build/Tone.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lamejs@1.2.0/lame.min.js"></script>
    <script type="module" src="/js/app.js"></script>
    
    <script type="module">
      import jwtDecode from 'https://cdn.jsdelivr.net/npm/jwt-decode@4.0.0/build/esm/index.js';

      function getTokenFromUrl() {
        const hash = window.location.hash.substring(1);
        const params = new URLSearchParams(hash);
        return {
          idToken: params.get('id_token'),
          accessToken: params.get('access_token'),
        };
      }

      const { idToken } = getTokenFromUrl();

      if (idToken) {
        localStorage.setItem('idToken', idToken);
        const decoded = jwtDecode(idToken);
        const name = decoded.given_name || decoded.name || decoded.email || 'User';
        console.log('Signed in as:', name);
        window.history.replaceState({}, document.title, window.location.pathname);
      }
    </script>
  </body>
</html>